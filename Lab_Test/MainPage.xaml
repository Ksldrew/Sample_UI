<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="Lab_Test.MainPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    Title=""
    BackgroundColor="#111111">

    <ScrollView>
        <!-- One big Grid so we can overlap avatar over top bar + card -->
        <Grid Padding="0,40,0,24">

            <!-- 1) Top black bar with back icon, title, and (optional) bookmark icon -->
            <Grid
                Margin="24,0,24,0"
                HeightRequest="40"
                VerticalOptions="Start"
                ColumnDefinitions="Auto,*,Auto">

                <!-- Back icon (visual only) -->
                <Image
                    Grid.Column="0"
                    Source="icon_back.png"
                    HeightRequest="20"
                    WidthRequest="20"
                    VerticalOptions="Center" />

                <!-- Center text that will be partially covered by avatar -->
                <Label
                    Grid.Column="1"
                    Text="Overview"
                    FontSize="16"
                    TextColor="#666666"
                    HorizontalTextAlignment="Center"
                    VerticalTextAlignment="Center" />

                <!-- Right icon (e.g., bookmark) – purely decorative -->
                <Image
                    Grid.Column="2"
                    Source="icon_bookmark.png"
                    HeightRequest="20"
                    WidthRequest="20"
                    VerticalOptions="Center"
                    HorizontalOptions="End" />
            </Grid>

            <!-- 2) Main dark card, slightly lower so avatar can overlap -->
            <Frame
                Margin="0,80,0,0"
                Padding="24,40,24,24"
                CornerRadius="24"
                BackgroundColor="#1B1B1B"
                HasShadow="False"
                VerticalOptions="Start">


                <VerticalStackLayout Spacing="20">

                    <!-- Name + nationality/years -->
                    <VerticalStackLayout
                        HorizontalOptions="Center"
                        Spacing="4">
                        <Label
                            Text="Vincent van Gogh"
                            FontSize="26"
                            FontAttributes="Bold"
                            TextColor="#F2F2F2"
                            HorizontalTextAlignment="Center" />
                        <Label
                            Text="Dutch, 1853 — 1890"
                            FontSize="14"
                            TextColor="#BBBBBB"
                            HorizontalTextAlignment="Center" />
                    </VerticalStackLayout>

                    <!-- B) Description with tail truncation + Toolkit Expander -->
                    <toolkit:Expander x:Name="DescriptionExpander">

                        <toolkit:Expander.Header>
                            <Grid>

                                <!-- 收起状态：简介 + Read More -->
                                <Grid x:Name="CollapsedHeader">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <!-- 简介文字：居中 + TailTruncation -->
                                    <Label
                    Grid.Column="0"
                    FontSize="14"
                    TextColor="#DDDDDD"
                    HorizontalTextAlignment="Center"
                    LineBreakMode="TailTruncation"
                    MaxLines="2"
                    Text="Was a Dutch Post-Impressionist painter who is among the most famous and influential figures in the history of Western art." />

                                    <!-- Read More 按钮，始终在右侧，略微往下对齐 -->
                                    <Label
                    Grid.Column="1"
                    Text="Read More"
                    FontSize="14"
                    FontAttributes="Bold"
                    TextColor="#F6C453"
                    VerticalOptions="End"
                    Margin="8,0,0,0" />

                                    <!-- 展开时，整个 CollapsedHeader 隐藏 -->
                                    <Grid.Triggers>
                                        <DataTrigger
                        TargetType="Grid"
                        Binding="{Binding Source={x:Reference DescriptionExpander}, Path=IsExpanded}"
                        Value="True">
                                            <Setter Property="IsVisible" Value="False" />
                                        </DataTrigger>
                                    </Grid.Triggers>
                                </Grid>

                                <!-- 展开状态：只显示全文描述（没有 Read More） -->
                                <Label
                x:Name="ExpandedDescriptionLabel"
                FontSize="14"
                TextColor="#DDDDDD"
                HorizontalTextAlignment="Center"
                IsVisible="False"
                Text="Was a Dutch Post-Impressionist painter who is among the most famous and influential figures in the history of Western art. In just over a decade, he created about 2,100 artworks, including around 860 oil paintings, most of which date from the last two years of his life.">

                                    <Label.Triggers>
                                        <DataTrigger
                        TargetType="Label"
                        Binding="{Binding Source={x:Reference DescriptionExpander}, Path=IsExpanded}"
                        Value="True">
                                            <Setter Property="IsVisible" Value="True" />
                                        </DataTrigger>
                                    </Label.Triggers>
                                </Label>

                            </Grid>
                        </toolkit:Expander.Header>

                        <!-- 内容可以留空，只是满足 Expander 结构 -->
                        <Grid />
                    </toolkit:Expander>

                    <!-- C) Stats row inside its own 'box' with top & bottom divider -->
                    <VerticalStackLayout Spacing="6" Margin="0,10,0,0">

                        <!-- Top divider -->
                        <BoxView
                            HeightRequest="1"
                            BackgroundColor="#333333" />

                        <!-- Equal-width stats grid -->
                        <Grid ColumnDefinitions="*,*,*,*"
                              ColumnSpacing="8"
                              Margin="0,6,0,6">

                            <VerticalStackLayout Grid.Column="0" Spacing="2">
                                <Label Text="$7.5m"
                                       FontSize="16"
                                       FontAttributes="Bold"
                                       TextColor="White"
                                       HorizontalTextAlignment="Center" />
                                <Label Text="Record"
                                       FontSize="12"
                                       TextColor="#A0A0A0"
                                       HorizontalTextAlignment="Center" />
                            </VerticalStackLayout>

                            <VerticalStackLayout Grid.Column="1" Spacing="2">
                                <Label Text="$3.5m"
                                       FontSize="16"
                                       FontAttributes="Bold"
                                       TextColor="White"
                                       HorizontalTextAlignment="Center" />
                                <Label Text="Average"
                                       FontSize="12"
                                       TextColor="#A0A0A0"
                                       HorizontalTextAlignment="Center" />
                            </VerticalStackLayout>

                            <VerticalStackLayout Grid.Column="2" Spacing="2">
                                <Label Text="+598%"
                                       FontSize="16"
                                       FontAttributes="Bold"
                                       TextColor="White"
                                       HorizontalTextAlignment="Center" />
                                <Label Text="General"
                                       FontSize="12"
                                       TextColor="#A0A0A0"
                                       HorizontalTextAlignment="Center" />
                            </VerticalStackLayout>

                            <VerticalStackLayout Grid.Column="3" Spacing="2">
                                <Label Text="12"
                                       FontSize="16"
                                       FontAttributes="Bold"
                                       TextColor="White"
                                       HorizontalTextAlignment="Center" />
                                <Label Text="Items"
                                       FontSize="12"
                                       TextColor="#A0A0A0"
                                       HorizontalTextAlignment="Center" />
                            </VerticalStackLayout>
                        </Grid>

                        <!-- Bottom divider -->
                        <BoxView
                            HeightRequest="1"
                            BackgroundColor="#333333" />
                    </VerticalStackLayout>

                    <!-- Other works title -->
                    <Label
                        Text="Other Van Gogh Works"
                        FontSize="16"
                        FontAttributes="Bold"
                        TextColor="White"
                        Margin="0,10,0,0" />

                    <!-- D) 2-column artwork grid using CollectionView -->
                    <CollectionView
                        ItemsSource="{Binding ArtWorks}"
                        SelectionMode="None">

                        <CollectionView.ItemsLayout>
                            <GridItemsLayout
                                Orientation="Vertical"
                                Span="2" />
                        </CollectionView.ItemsLayout>

                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Frame
                                    Margin="4"
                                    Padding="0"
                                    CornerRadius="16"
                                    HasShadow="False"
                                    BackgroundColor="#303030">

                                    <VerticalStackLayout Spacing="4">
                                        <Image
                                            Source="{Binding Image}"
                                            Aspect="AspectFill"
                                            HeightRequest="150" />

                                        <StackLayout Padding="8,6,8,10">
                                            <Label
                                                Text="{Binding Title}"
                                                FontSize="13"
                                                TextColor="White" />
                                            <Label
                                                Text="{Binding Price}"
                                                FontSize="12"
                                                TextColor="#BBBBBB" />
                                        </StackLayout>
                                    </VerticalStackLayout>
                                </Frame>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                </VerticalStackLayout>
            </Frame>

            <!-- 3) Floating circular avatar (centered, overlapping both bar and card) -->
            <Border
                HorizontalOptions="Center"
                VerticalOptions="Start"
                WidthRequest="96"
                HeightRequest="96"
                Stroke="Gold"
                StrokeThickness="4"
                BackgroundColor="#111111"
                Margin="0,20,0,0">

                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="48" />
                </Border.StrokeShape>

                <Image
                    Source="vincent.jpg"
                    Aspect="AspectFill" />
            </Border>

        </Grid>
    </ScrollView>
</ContentPage>
